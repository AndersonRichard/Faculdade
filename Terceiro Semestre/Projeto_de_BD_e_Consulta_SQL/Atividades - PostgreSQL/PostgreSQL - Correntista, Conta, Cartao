//C:\Program Files\PostgreSQL\15\bin
CREATE DATABASE BANK;
\l
\c BANK;

CREATE TABLE CARTAO(
    NUMERO NUMERIC(20) NOT NULL,
    SENHA NUMERIC(6) NOT NULL,
    EMISSAO DATE NOT NULL,
    LIMITE FLOAT NOT NULL,
    VALIDADE DATE NOT NULL,
    CPF_CORRENTISTA VARCHAR(11) NOT NULL,           //CHAVE ESTRANGEIRA
    NUMERO_CONTA INTEGER NOT NULL                   //CHAVE ESTRANGEIRA
);
ALTER TABLE CARTAO ADD CONSTRAINT CARTAO_PK PRIMARY KEY (NUMERO);
ALTER TABLE CARTAO ADD CONSTRAINT CARTAO_FK_CORRENTISTA FOREIGN KEY (CPF_CORRENTISTA) REFERENCES CORRENTISTA (CPF);
ALTER TABLE CARTAO ADD CONSTRAINT CARTAO_FK_CONTA FOREIGN KEY (NUMERO_CONTA) REFERENCES CONTA (NUMERO);

CREATE TABLE CONTA(
    NUMERO INTEGER NOT NULL,
    SALDO NUMERIC(15,2) NOT NULL,
    CPF_CORRENTISTA VARCHAR(11) NOT NULL,           //CHAVE ESTRANGEIRA
    LIMITE FLOAT NOT NULL
);
ALTER TABLE CONTA ADD CONSTRAINT CONTA_PK PRIMARY KEY (NUMERO);
ALTER TABLE CONTA ADD CONSTRAINT CONTA_FK_CORRENTISTA FOREIGN KEY (CPF_CORRENTISTA) REFERENCES CORRENTISTA (CPF);

CREATE TABLE CORRENTISTA(
    CPF VARCHAR(11) NOT NULL,
    NOME VARCHAR(50) NOT NULL,
    EMAIL VARCHAR(100) NOT NULL,
    TELEFONE VARCHAR(13) NOT NULL,
    ENDERECO VARCHAR(200) NOT NULL
);
ALTER TABLE CORRENTISTA ADD CONSTRAINT CORRENTISTA_PK PRIMARY KEY (CPF);

INSERT INTO CORRENTISTA (CPF, NOME, EMAIL,TELEFONE, ENDERECO) 
VALUES ('11111111111','Aaaaaaaa Rrrrrrr dd Sssss','aaaaaaaaaa@hotmail.com','11111111111','Rua 18');

INSERT INTO CONTA (NUMERO, SALDO, CPF_CORRENTISTA,LIMITE) 
VALUES ('1111111','8.50','11111111111','100');

INSERT INTO CARTAO(NUMERO, SENHA, EMISSAO, LIMITE, VALIDADE, CPF_CORRENTISTA, NUMERO_CONTA )
VALUES ('11111', '11111', '30/05/2023', '1111', '30/05/2026', '11111111111', '11111')

SELECT * FROM CARTAO;
DELETE FROM CORRENTISTA WHERE CPF = '03128139610';
//RESTRIÇÕES
//TESTE COM NULL
INSERT INTO CORRENTISTA (CPF, NOME, EMAIL,TELEFONE, ENDERECO) 
VALUES ('12345678910','Silvio Cezar','Silviocezar@hotmail.com','35998751442',NULL);
INSERT INTO CORRENTISTA (CPF, NOME, EMAIL,TELEFONE, ENDERECO) 
VALUES ('12345142650','Anderson Richard da Silva','richard-r3@hotmail.com','35991629116','Rua 18');
//TESTE DA RESTRIÇÕES FK    
INSERT INTO CONTA (NUMERO, SALDO, CPF_CORRENTISTA,LIMITE) 
VALUES ('578','8.50','89621','100');