//C:\Program Files\PostgreSQL\15\bin
CREATE DATABASE LOCATOR;
\l
\c LOCATOR;

CREATE TABLE AUTOR(
    CPF VARCHAR(11) NOT NULL,
    NOME VARCHAR(50) NOT NULL,
    CIDADE VARCHAR(30) NOT NULL,
    DATA_NASCIMENTO DATE NOT NULL,
    QUANTIDADE_LIVRO NUMERIC(4) NOT NULL
);
ALTER TABLE AUTOR ADD CONSTRAINT AUTOR_PK PRIMARY KEY (CPF);

CREATE TABLE ESCREVE(
    CPF_AUTOR VARCHAR(11) NOT NULL,             //CHAVE ESTRANGEIRA
    ETIQUETA_LIVRO NUMERIC(10) NOT NULL         //CHAVE ESTRANGEIRA
);
ALTER TABLE ESCREVE ADD CONSTRAINT ESCREVE_PK PRIMARY KEY (CPF_AUTOR);
ALTER TABLE ESCREVE ADD CONSTRAINT ESCREVE_FK_AUTOR FOREIGN KEY (CPF_AUTOR) REFERENCES AUTOR (CPF);
ALTER TABLE ESCREVE ADD CONSTRAINT ESCREVE_FK_LIVRO FOREIGN KEY (ETIQUETA_LIVRO) REFERENCES LIVRO (ETIQUETA);

CREATE TABLE LIVRO(
    ETIQUETA NUMERIC(10) NOT NULL,
    TITULO VARCHAR(50) NOT NULL,
    CATEGORIA VARCHAR(30) NOT NULL,
    ANO_LANCAMENTO NUMERIC(4) NOT NULL,
    QUANTIDADE_COPIA NUMERIC(2) NOT NULL
);
ALTER TABLE LIVRO ADD CONSTRAINT LIVRO_PK PRIMARY KEY (ETIQUETA);

CREATE TABLE ALUGA(
    ETIQUETA_LIVRO NUMERIC(10) NOT NULL,        //CHAVE ESTRANGEIRA
    EMAIL_CLIENTE VARCHAR(60) NOT NULL,         //CHAVE ESTRANGEIRA
    DATA_SAIDA DATE NOT NULL,
    DATA_DEVOLUCAO DATE NOT NULL
);
ALTER TABLE ALUGA ADD CONSTRAINT ALUGA_PK PRIMARY KEY (ETIQUETA_LIVRO);
ALTER TABLE ALUGA ADD CONSTRAINT ALUGA_FK_LIVRO FOREIGN KEY (ETIQUETA_LIVRO) REFERENCES LIVRO (ETIQUETA);
ALTER TABLE ALUGA ADD CONSTRAINT ALUGA_FK_CLIENTE FOREIGN KEY (EMAIL_CLIENTE) REFERENCES CLIENTE (EMAIL);

CREATE TABLE CLIENTE(
    EMAIL VARCHAR(60) NOT NULL, 
    NOME VARCHAR(50) NOT NULL,
    TELEFONE NUMERIC(13) NOT NULL,
    ENDERECO VARCHAR(100) NOT NULL
);
ALTER TABLE CLIENTE ADD CONSTRAINT CLIENTE_PK PRIMARY KEY (EMAIL);

CREATE TABLE CARTAO(
    NUMERO NUMERIC(15) NOT NULL,
    STATUS VARCHAR(30) NOT NULL,
    CREDITO DECIMAL(10,2) NOT NULL,
    EMAIL_CLIENTE VARCHAR(60) NOT NULL          //CHAVE ESTRANGEIRA
);
ALTER TABLE CARTAO ADD CONSTRAINT CARTA_PK PRIMARY KEY (NUMERO);
ALTER TABLE CARTAO ADD CONSTRAINT CARTAO_FK_CLIENTE FOREIGN KEY (EMAIL_CLIENTE) REFERENCES CLIENTE (EMAIL);